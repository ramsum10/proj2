from flask_restful import Resource, reqparse
from flask_jwt import jwt_required
import sqlite3


class Item(Resource):
    TABLE_NAME = 'items'


    parser = reqparse.RequestParser()
    parser.add_argument('price',
                    type=float,
                    required=True,
                    help="This field cannot be left blank!"
                    )


    @classmethod
    def find_by_name(cls, name):
        connection = sqlite3.connect('data.db')
        cursor = connection.cursor()
        query = 'SELECT * FROM {table} WHERE name=?'.format(table=cls.TABLE_NAME)
        row = cursor.execute(query,(name,))
        result = row.fetchone()
        connection.close
        if result:
            return {'item': {'name': result[0], 'price': result[1]}}

    def get(self,name):
        item = self.find_by_name(name)
        if item:
            return item

    def post(self):
        data = Item.parser.parse_args()
        connection = sqlite3.connect()
        cursor = connection.cursor()
        query = 'INSERT INTO {table} VALUES(?,?)'.format(table = self.TABLE_NAME)
        cursor.execute(query,(data['name'],data['price']))
        connection.commit()
        connection.close()




